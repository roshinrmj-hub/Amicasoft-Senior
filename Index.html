/* --- CONTENT GENERATORS --- */
const generators = {

    // ... (All other generators like generateRootsManual, generateExponentsFrac, generateVolume, generateLinear, generateQuadFormula8, generateAnglesBisect, generateCircles remain unchanged) ...

    // ================= CLASS 9 =================

    generateHeron: function() {
        // Generate sides that form a valid triangle (a+b>c) and aim for a whole/simple area
        // Use Pythagorean triples (3,4,5), (5,12,13) scaled up or simple near-isosceles
        
        let a, b, c, s, area;
        
        // Simple 3,4,5 or a multiple (e.g., 6,8,10)
        const scale = Math.floor(Math.random() * 2) + 1; 
        if (scale === 1) {
            // Keep the easy (3, 4, 5) for simplicity
            a = 3; b = 4; c = 5;
        } else {
            // Use (6, 8, 10)
            a = 6; b = 8; c = 10;
        }
        
        s = (a + b + c) / 2;
        area = Math.sqrt(s * (s - a) * (s - b) * (s - c));

        return {
            answer: area,
            desc: "Calculate Triangle Area.",
            display: `Sides: ${a}, ${b}, ${c}`,
            formula: "Area = ‚àös(s-a)(s-b)(s-c), where s = (a+b+c)/2",
            steps: [
                `1. Find semi-perimeter s: (${a}+${b}+${c})/2 = <b>${s}</b>`, 
                `2. Calculate inner product: ${s} √ó (${s}-${a}) √ó (${s}-${b}) √ó (${s}-${c})`, 
                `3. = ${s} √ó ${s-a} √ó ${s-b} √ó ${s-c} = ${area*area}`, 
                `4. Area = ‚àö${area*area} = <b>${area}</b>`
            ],
            svg: `<svg width="150" height="100"><polygon points="20,90 20,${90-(a*5)} 120,90" fill="#FFE66D" stroke="#333" stroke-width="2"/><text x="10" y="55">${a}</text><text x="70" y="98">${b}</text><text x="80" y="50">${c}</text></svg>`
        };
    },

    generateStats: function() {
        // Generate a random dataset of 6 numbers that sum to a multiple of 6 for a clean mean
        const count = 6;
        const targetMean = Math.floor(Math.random() * 5) + 4; // Mean between 4 and 8
        const targetSum = targetMean * count;
        let nums = [];
        let currentSum = 0;

        for (let i = 0; i < count - 1; i++) {
            // Generate a random number between 1 and 10
            const num = Math.floor(Math.random() * 10) + 1; 
            nums.push(num);
            currentSum += num;
        }

        // Calculate the last number to make the sum exact
        let lastNum = targetSum - currentSum;
        // Ensure lastNum is positive and not too large/small (keep it between 1 and 15)
        if (lastNum <= 0 || lastNum > 15) {
             // If calculation results in a bad last number, just restart with a simple set
             nums = [2, 4, 4, 5, 7, 8]; 
             targetSum = 30;
             targetMean = 5;
        } else {
            nums.push(lastNum);
        }

        // Shuffle the array to make the question less predictable
        for (let i = nums.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [nums[i], nums[j]] = [nums[j], nums[i]];
        }
        
        return {
            answer: targetMean,
            desc: "Find the Mean of the dataset.",
            display: `Data: [ ${nums.join(', ')} ]`,
            formula: "Mean = Sum / Count",
            realWorld: "üåç <b>Scenario:</b> Used to determine the average score of a class.",
            steps: [`1. Sum = ${targetSum}`, `2. Count = ${count}`, `3. ${targetSum} √∑ ${count} = <b>${targetMean}</b>`]
        };
    },

    // ================= CLASS 10 =================
    
    generateAPTerm: function() {
        // ... (unchanged) ...
    },

    generateAPSum: function() {
        const a = Math.floor(Math.random()*5)+1; // first term
        const d = Math.floor(Math.random()*3)+2; // common difference
        const n = Math.floor(Math.random()*6)+7; // number of terms (7 to 12)
        const ans = (n/2) * (2*a + (n-1)*d);
        return {
            answer: ans,
            desc: `Find the Sum of the first ${n} terms.`,
            realWorld: `üåç <b>Scenario (Summation):</b> You save $${a} in week 1, and increase savings by $${d} each week. How much total money after ${n} weeks?`,
            display: `Series: ${a}, ${a+d}, ${a+2*d}... (n=${n})`,
            formula: "S<sub>n</sub> = (n/2) √ó [2a + (n-1)d]",
            steps: [`1. n=${n}, a=${a}, d=${d}`, `2. 2a = ${2*a}`, `3. (n-1)d = ${n-1} √ó ${d} = ${(n-1)*d}`, `4. Bracket Sum = ${2*a + (n-1)*d}`, `5. ${n/2} √ó ${2*a + (n-1)*d} = <b>${ans}</b>`]
        };
    },

    generateGPTerm: function() {
        const a = Math.floor(Math.random()*5)+2; // first term
        const r = Math.floor(Math.random()*2)+2; // common ratio (2 or 3)
        const n = Math.floor(Math.random()*3)+4; // term number (4 to 6)
        const ans = a * Math.pow(r, n-1); 
        return {
            answer: ans,
            desc: `Find the ${n}th term of the Geometric Progression.`,
            realWorld: `üåç <b>Scenario:</b> A bacteria culture starts with ${a}. It multiplies by ${r} every hour.`,
            display: `a = ${a}, r = ${r}, n = ${n}`,
            formula: "a<sub>n</sub> = a √ó r<sup>(n - 1)</sup>",
            steps: [`1. a=${a}, r=${r}, n=${n}`, `2. r<sup>n-1</sup> = ${r}<sup>${n-1}</sup> = ${Math.pow(r, n-1)}`, `3. ${a} √ó ${Math.pow(r, n-1)} = <b>${ans}</b>`]
        };
    },

    generateGPSum: function() {
        const a = Math.floor(Math.random()*3)+1; // first term
        const r = Math.floor(Math.random()*2)+2; // common ratio (2 or 3)
        const n = Math.floor(Math.random()*3)+4; // number of terms (4 to 6)
        const r_pow_n = Math.pow(r, n);
        const numerator = a * (r_pow_n - 1);
        const denominator = r - 1;
        const ans = numerator / denominator;
        return {
            answer: ans,
            desc: "Calculate the Total Sum (Viral Growth).",
            realWorld: `üåç <b>Scenario (Multiplication/Growth):</b> A post gets ${a} share. Each share gets ${r} reshares (Multiplication). What is the TOTAL shares after ${n} cycles?`,
            display: `a = ${a}, r = ${r}, n = ${n}`,
            formula: "S<sub>n</sub> = a(r<sup>n</sup> - 1) / (r - 1)",
            steps: [`1. r<sup>n</sup> = ${r}<sup>${n}</sup> = ${r_pow_n}`, `2. (r<sup>n</sup> - 1) = ${r_pow_n - 1}`, `3. Numerator: ${a} √ó ${r_pow_n - 1} = ${numerator}`, `4. Denominator: ${r} - 1 = ${denominator}`, `5. ${numerator} / ${denominator} = <b>${ans}</b>`]
        };
    },
    
    // ... (All other generators like generateTrig, generateTrigAdvanced, generateQuadFormula10 remain unchanged) ...
};
